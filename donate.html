<!DOCTYPE html>
<html lang="uk" x-data="donateApp()">
<head>
  <meta charset="UTF-8">
  <title>Donate</title>
  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</head>
<body class="bg-gray-900 text-white p-6">

  <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
    <!-- Приклад кнопок -->
    <button 
      class="bg-gray-800 p-4 rounded-xl hover:bg-green-600 transition"
      @click="selectOption('vip')">
      VIP
    </button>

    <button 
      class="bg-gray-800 p-4 rounded-xl hover:bg-green-600 transition"
      @click="selectOption('premium')">
      Premium
    </button>
  </div>

  <!-- Вибраний товар -->
  <div class="mt-6 p-4 bg-gray-800 rounded-xl" x-show="selected">
    <h2 class="text-xl font-bold" x-text="selected?.title"></h2>
    <p class="mt-2 text-green-400 font-bold" x-text="selected ? selected.price + ' грн' : ''"></p>
    <p class="mt-1 text-gray-300" x-text="selected ? selected.desc : ''"></p>

    <button 
      class="mt-4 px-6 py-2 bg-green-500 text-white rounded-xl hover:bg-green-600"
      @click="pay">
      Оплатити
    </button>
  </div>

  <script>
    function donateApp() {
      return {
        selected: null,
        options: {
          vip: { title: "VIP", price: 50, desc: "VIP доступ" },
          premium: { title: "Premium", price: 100, desc: "Premium доступ" }
        },
        selectOption(option) {
          this.selected = this.options[option];
        },
        async pay() {
          if (!this.selected) return;

          try {
            let res = await fetch("https://web-production-0323.up.railway.app/create-payment", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ amount: this.selected.price, description: this.selected.title })
            });

            let data = await res.json();
            if (data && data.payment_url) {
              window.location.href = data.payment_url;
            } else {
              alert("Помилка при створенні платежу");
            }
          } catch (err) {
            console.error(err);
            alert("Сервер не відповідає");
          }
        }
      }
    }
  </script>

</body>
</html>
